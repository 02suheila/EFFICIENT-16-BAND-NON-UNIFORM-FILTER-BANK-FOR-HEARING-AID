clc;
clear all;
close all;
% First
% i=[25 30 25 35 25 30];
%Second
% i=[60 60 55 50 40 60];
%Third
i=[34 33 30 25 20 35];
f=[250 500 1000 2000 4000 8000];
c=i(5)-(4000*(i(6)-i(5))/(8000-4000));
g=[i(1) (i(1)+i(2))/2 ((i(2)+i(3))/2+i(2))/2 ((i(2)+i(3))/2+i(3))/2 ((i(3)+i(4))/2+i(3))/2 ((i(3)+i(4))/2+i(4))/2 ((i(4)+i(5))/2+i(4))/2 ((i(4)+i(5))/2+i(5))/2 4500*(i(6)-i(5))/(8000-4000)+c ... 
    5500*(i(6)-i(5))/(8000-4000)+c 6250*(i(6)-i(5))/(8000-4000)+c 6750*(i(6)-i(5))/(8000-4000)+c 7125*(i(6)-i(5))/(8000-4000)+c 7375*(i(6)-i(5))/(8000-4000)+c 7625*(i(6)-i(5))/(8000-4000)+c 7875*(i(6)-i(5))/(8000-4000)+c];
G=10.^(g/20);
j=[125 375 625 875 1250 1750 2500 3500 4500 5500 6250 6750 7125 7375 7625 7875];
plot(f,i,j,g);
grid
axis([0 8000 -10 100]);
set(gca, 'yDir', 'reverse'); 
xlabel('Frequency (Hz)')
ylabel('Intensity of HL(dB)')
title('Audiogram1 Actual Values');
Fs=16000;
h1=[-0.000136315323397503952 -0.000101073730476899983 -5.93088095329570217e-05 8.98707927771719706e-20 8.89881595676533029e-05 0.000220641488288296451 0.000408497584471601938 0.000666318096422314631 0.00100773695285724337 0.00144588979552523608 0.00199303000388702418 0.00266013697959760227 0.00345652286972179682 0.00438944472149173631 0.005463730196249246 0.00668142638060545847 0.00804148280470020141 0.00953948133188132 0.0111674268907073649 0.0129136138186164359 0.0147625826150624018 0.0166951809290135193 0.0186887404626737835 0.0207173780825011082 0.0227524248248216036 0.0247629808246720359 0.0267165877629903896 0.0285800036064592297 0.0303200576743623863 0.0319045579193598453 0.0333032172649833508 0.0344885623650218742 0.0354367866090931488 0.0361285098335379015 0.036549410087170893 0.0366906978541870557 0.036549410087170893 0.0361285098335379015 0.0354367866090931488 0.0344885623650218742 0.0333032172649833508 0.0319045579193598453 0.0303200576743623863 0.0285800036064592297 0.0267165877629903896 0.0247629808246720359 0.0227524248248216036 0.0207173780825011082 0.0186887404626737835 0.0166951809290135193 0.0147625826150624018 0.0129136138186164359 0.0111674268907073649 0.00953948133188132 0.00804148280470020141 0.00668142638060545847 0.005463730196249246 0.00438944472149173631 0.00345652286972179682 0.00266013697959760227 0.00199303000388702418 0.00144588979552523608 0.00100773695285724337 0.000666318096422314631 0.000408497584471601938 0.000220641488288296451 8.89881595676533029e-05 8.98707927771719706e-20 -5.93088095329570217e-05 -0.000101073730476899983 -0.000136315323397503952];
h2=[0.000654256851461895543 0.000493051424550999709 0.000292129821246409386 -4.44090687182551405e-19 -0.000438317601588342047 -0.00107631923351696472 -0.00196061848943296195 -0.00312547975221705255 -0.00458767155316873888 -0.00634202990966881066 -0.00835810149795374394 -0.0105781939202459832 -0.012917096839796886 -0.0152636554077810131 -0.0174842786650496636 -0.0194283534911964574 -0.020935413021345748 -0.0218437822319009871 -0.0220002990356821561 -0.0212705947338512891 -0.0195493224735975614 -0.0167696567501136665 -0.012911361177312234 -0.00800674457282606056 -0.00214390286273511473 0.00453322184937854887 0.0118282471456943126 0.0194992735685470403 0.0272691206425699773 0.0348384067730812055 0.041900756508583388 0.0481592119996581275 0.0533427822573905863 0.0572220017022776126 0.0596223990358399764 0.0604349003710733246 0.0596223990358399764 0.0572220017022776126 0.0533427822573905863 0.0481592119996581275 0.041900756508583388 0.0348384067730812055 0.0272691206425699773 0.0194992735685470403 0.0118282471456943126 0.00453322184937854887 -0.00214390286273511473 -0.00800674457282606056 -0.012911361177312234 -0.0167696567501136665 -0.0195493224735975614 -0.0212705947338512891 -0.0220002990356821561 -0.0218437822319009871 -0.020935413021345748 -0.0194283534911964574 -0.0174842786650496636 -0.0152636554077810131 -0.012917096839796886 -0.0105781939202459832 -0.00835810149795374394 -0.00634202990966881066 -0.00458767155316873888 -0.00312547975221705255 -0.00196061848943296195 -0.00107631923351696472 -0.000438317601588342047 -4.44090687182551405e-19 0.000292129821246409386 0.000493051424550999709 0.000654256851461895543];
h3=[-0.00102952293857410532 -0.000802140354897014785 -0.000484643183233477424 7.41508448559086757e-19 0.000727168615633581698 0.00175105282931086554 0.00308518237776728328 0.00468618890034106731 0.00644383648620885409 0.00817979292200712686 0.009656666367886306 0.0105975924135528008 0.0107152584058817415 0.00974785623859009652 0.00749823304850051522 0.00387162665382410941 -0.00109302990737695756 -0.00720307313487104483 -0.0141073818606346837 -0.0213096011552392599 -0.0282000710202511932 -0.0341050075812589851 -0.0383492032394331106 -0.0403264392207267064 -0.0395702327638016924 -0.035816735572391567 -0.0290517516032800655 -0.0195350317074750209 -0.00779717391519785512 0.00539259028215924221 0.0190860440211831663 0.03223796706029676 0.0438023718104001147 0.0528328072603993087 0.0585756433536951671 0.0605457270414090643 0.0585756433536951671 0.0528328072603993087 0.0438023718104001147 0.03223796706029676 0.0190860440211831663 0.00539259028215924221 -0.00779717391519785512 -0.0195350317074750209 -0.0290517516032800655 -0.035816735572391567 -0.0395702327638016924 -0.0403264392207267064 -0.0383492032394331106 -0.0341050075812589851 -0.0282000710202511932 -0.0213096011552392599 -0.0141073818606346837 -0.00720307313487104483 -0.00109302990737695756 0.00387162665382410941 0.00749823304850051522 0.00974785623859009652 0.0107152584058817415 0.0105975924135528008 0.009656666367886306 0.00817979292200712686 0.00644383648620885409 0.00468618890034106731 0.00308518237776728328 0.00175105282931086554 0.000727168615633581698 7.41508448559086757e-19 -0.000484643183233477424 -0.000802140354897014785 -0.00102952293857410532];
h4=[0.00131386743618066345 0.00107862911854385702 0.000671411784542619901 -1.03727499524445963e-18 -0.00100740007241724569 -0.00235462105636836732 -0.00393728056845533709 -0.00552328073851898749 -0.00676437110077387268 -0.00724299509030349245 -0.00655069450737530857 -0.00438612795038376829 -0.000654063810752392606 0.0044568130838923449 0.0104386350050754851 0.0164874653823925479 0.0215909657045400723 0.024674433126384239 0.0247861775429085406 0.0212924232641823127 0.0140456602689573041 0.00349047946121862828 -0.00932181342046266986 -0.0228246788040495779 -0.0351303809959838537 -0.0443032171177454998 -0.0486711442628645283 -0.0471237209218159578 -0.0393419815951729368 -0.0259138379369879303 -0.00830611771443354185 0.0113113430470639723 0.0303674102714003614 0.0462710132321902667 0.0568096037577036569 0.0604969205013192804 0.0568096037577036569 0.0462710132321902667 0.0303674102714003614 0.0113113430470639723 -0.00830611771443354185 -0.0259138379369879303 -0.0393419815951729368 -0.0471237209218159578 -0.0486711442628645283 -0.0443032171177454998 -0.0351303809959838537 -0.0228246788040495779 -0.00932181342046266986 0.00349047946121862828 0.0140456602689573041 0.0212924232641823127 0.0247861775429085406 0.024674433126384239 0.0215909657045400723 0.0164874653823925479 0.0104386350050754851 0.0044568130838923449 -0.000654063810752392606 -0.00438612795038376829 -0.00655069450737530857 -0.00724299509030349245 -0.00676437110077387268 -0.00552328073851898749 -0.00393728056845533709 -0.00235462105636836732 -0.00100740007241724569 -1.03727499524445963e-18 0.000671411784542619901 0.00107862911854385702 0.00131386743618066345];
h5=[2.67186121963066192e-05 0.000112290871963405313 0.00010459627338586592 -1.79715594257487995e-19 -0.000156938403241277277 -0.000245128234550110835 -8.00679503271786627e-05 0.000509904047700173065 0.00155775710759054205 0.0028358047299334747 0.00381387002264197122 0.00376145779496880189 0.00200646106768008438 -0.00171242870904977224 -0.00693130504870953946 -0.0123438809331389236 -0.0160032072765362264 -0.0158612837572731299 -0.0105270547189127428 7.90616448827957918e-18 0.0139160539399231578 0.0277590565861377571 0.0371921192428276565 0.0382751876215451856 0.028863796599424188 0.00966063864028023946 -0.0155085891886527858 -0.0404123840878353804 -0.058020581137011952 -0.0625739918313006349 -0.0514800248746151851 -0.0263925858290640462 0.00694582043524658455 0.0401380443049308422 0.0644580816859169764 0.0733707844876391874 0.0644580816859169764 0.0401380443049308422 0.00694582043524658455 -0.0263925858290640462 -0.0514800248746151851 -0.0625739918313006349 -0.058020581137011952 -0.0404123840878353804 -0.0155085891886527858 0.00966063864028023946 0.028863796599424188 0.0382751876215451856 0.0371921192428276565 0.0277590565861377571 0.0139160539399231578 7.90616448827957918e-18 -0.0105270547189127428 -0.0158612837572731299 -0.0160032072765362264 -0.0123438809331389236 -0.00693130504870953946 -0.00171242870904977224 0.00200646106768008438 0.00376145779496880189 0.00381387002264197122 0.0028358047299334747 0.00155775710759054205 0.000509904047700173065 -8.00679503271786627e-05 -0.000245128234550110835 -0.000156938403241277277 -1.79715594257487995e-19 0.00010459627338586592 0.000112290871963405313 2.67186121963066192e-05];
h6=[-0.000128487286183473693 3.94278346872899824e-05 9.16713189542485212e-05 -1.79699752522947135e-19 -0.000137545535361737538 -8.60700014172006473e-05 0.000385039221806384889 0.00123090875463091934 0.00192823939335524529 0.001606212744487171 -0.00039061127116811115 -0.00376112622654748699 -0.00687815634087746153 -0.00729768094497375026 -0.00317133604511685369 0.00511255218917012685 0.0141806082036385651 0.0187080106326035916 0.0141657835317268114 -1.10676545958476307e-17 -0.01872620718638629 -0.032741153472295656 -0.0329563232002140633 -0.0158527042933544575 0.0132062862493286925 0.0411697480595097295 0.0531635040341601334 0.0404088217800483013 0.00594238734337911544 -0.0354421946236154611 -0.0637235493585263518 -0.0637117220403893014 -0.0334017954033525438 0.014093364383541921 0.056493000889334101 0.0733643169326353706 0.056493000889334101 0.014093364383541921 -0.0334017954033525438 -0.0637117220403893014 -0.0637235493585263518 -0.0354421946236154611 0.00594238734337911544 0.0404088217800483013 0.0531635040341601334 0.0411697480595097295 0.0132062862493286925 -0.0158527042933544575 -0.0329563232002140633 -0.032741153472295656 -0.01872620718638629 -1.10676545958476307e-17 0.0141657835317268114 0.0187080106326035916 0.0141806082036385651 0.00511255218917012685 -0.00317133604511685369 -0.00729768094497375026 -0.00687815634087746153 -0.00376112622654748699 -0.00039061127116811115 0.001606212744487171 0.00192823939335524529 0.00123090875463091934 0.000385039221806384889 -8.60700014172006473e-05 -0.000137545535361737538 -1.79699752522947135e-19 9.16713189542485212e-05 3.94278346872899824e-05 -0.000128487286183473693];
h7=[-0.000436019256172118675 -0.000129286770259734327 0.000111754255297686394 -3.06281499084581075e-19 -0.000167678386754139364 0.000282229865975062273 0.00130662355845371212 0.00148348837617743841 -0.000590901258756594289 -0.00378528960053336116 -0.00436563855952869142 5.88793909666482469e-18 0.00621364710496642974 0.00767831791697804952 0.0017124335743365375 -0.00616163604060850599 -0.00780254676621496175 -0.00242718198440927463 0.00207250842928759921 -2.69482670269572908e-18 -0.00273971589043762141 0.00424784545066702376 0.0181334431724999162 0.0191056424464387704 -0.00713102857720526381 -0.0433171053306363601 -0.0480272963509852241 2.10862976741330874e-17 0.0664146614211401087 0.0835250319045903744 0.0195278271246548986 -0.0767852196335264553 -0.11334838192306837 -0.0462131785245892962 0.0688692310303715555 0.125042648384140087 0.0688692310303715555 -0.0462131785245892962 -0.11334838192306837 -0.0767852196335264553 0.0195278271246548986 0.0835250319045903744 0.0664146614211401087 2.10862976741330874e-17 -0.0480272963509852241 -0.0433171053306363601 -0.00713102857720526381 0.0191056424464387704 0.0181334431724999162 0.00424784545066702376 -0.00273971589043762141 -2.69482670269572908e-18 0.00207250842928759921 -0.00242718198440927463 -0.00780254676621496175 -0.00616163604060850599 0.0017124335743365375 0.00767831791697804952 0.00621364710496642974 5.88793909666482469e-18 -0.00436563855952869142 -0.00378528960053336116 -0.000590901258756594289 0.00148348837617743841 0.00130662355845371212 0.000282229865975062273 -0.000167678386754139364 -3.06281499084581075e-19 0.000111754255297686394 -0.000129286770259734327 -0.000436019256172118675];
h8=[-0.000247043164915536535 -0.000312199293073407919 3.92521065885435838e-05 -3.06353543235832244e-19 -5.88946693075468743e-05 0.000681523441761299376 0.000740316888908643502 -0.00148383732530193166 -0.00251899737460963349 0.00156828709894967487 0.00515083310104084112 -8.24505369738542894e-18 -0.00733122056487949935 -0.00318121153243704604 0.00730006175147454497 0.00616308539305123609 -0.00442082733787870896 -0.00586111400393674476 0.000727939366204495369 -2.69546058526175107e-18 -0.000962286580205164751 0.0102576183481037381 0.0102741865840485416 -0.0191101365141453892 -0.0303993975271694139 0.0179467529893378094 0.0566653845536996617 -2.95277606897736204e-17 -0.0783598623151615936 -0.034605339035848677 0.0832466415156173228 0.0768032812075806065 -0.0642218035372183332 -0.111594725717618498 0.0241893464358413982 0.125072061167804699 0.0241893464358413982 -0.111594725717618498 -0.0642218035372183332 0.0768032812075806065 0.0832466415156173228 -0.034605339035848677 -0.0783598623151615936 -2.95277606897736204e-17 0.0566653845536996617 0.0179467529893378094 -0.0303993975271694139 -0.0191101365141453892 0.0102741865840485416 0.0102576183481037381 -0.000962286580205164751 -2.69546058526175107e-18 0.000727939366204495369 -0.00586111400393674476 -0.00442082733787870896 0.00616308539305123609 0.00730006175147454497 -0.00318121153243704604 -0.00733122056487949935 -8.24505369738542894e-18 0.00515083310104084112 0.00156828709894967487 -0.00251899737460963349 -0.00148383732530193166 0.000740316888908643502 0.000681523441761299376 -5.88946693075468743e-05 -3.06353543235832244e-19 3.92521065885435838e-05 -0.000312199293073407919 -0.000247043164915536535];
h9=[0.000247043164915533391 -0.000312199293073404992 -3.92521065885419711e-05 -3.06353543235832195e-19 5.88946693075491714e-05 0.000681523441761291027 -0.000740316888908650658 -0.00148383732530192559 0.00251899737460964303 0.00156828709894967183 -0.00515083310104084285 2.19907787619272619e-17 0.00733122056487949415 -0.00318121153243708463 -0.0073000617514745441 0.00616308539305124477 0.00442082733787868901 -0.00586111400393674303 -0.000727939366204487671 -2.6954605852617503e-18 0.000962286580205172232 0.0102576183481037225 -0.0102741865840485832 -0.0191101365141453441 0.0303993975271693827 0.01794675298933774 -0.056665384553699627 3.79642637439946187e-17 0.0783598623151615242 -0.0346053390358487464 -0.0832466415156172257 0.0768032812075805649 0.0642218035372182083 -0.111594725717618415 -0.0241893464358413773 0.125072061167804588 -0.0241893464358413773 -0.111594725717618415 0.0642218035372182083 0.0768032812075805649 -0.0832466415156172257 -0.0346053390358487464 0.0783598623151615242 3.79642637439946187e-17 -0.056665384553699627 0.01794675298933774 0.0303993975271693827 -0.0191101365141453441 -0.0102741865840485832 0.0102576183481037225 0.000962286580205172232 -2.6954605852617503e-18 -0.000727939366204487671 -0.00586111400393674303 0.00442082733787868901 0.00616308539305124477 -0.0073000617514745441 -0.00318121153243708463 0.00733122056487949415 2.19907787619272619e-17 -0.00515083310104084285 0.00156828709894967183 0.00251899737460964303 -0.00148383732530192559 -0.000740316888908650658 0.000681523441761291027 5.88946693075491714e-05 -3.06353543235832195e-19 -3.92521065885419711e-05 -0.000312199293073404992 0.000247043164915533391];
h10=[0.000436019256172120897 -0.000129286770259735601 -0.00011175425529768901 -3.06281499084580642e-19 0.000167678386754142671 0.000282229865975059183 -0.00130662355845370887 0.00148348837617743711 0.000590901258756573256 -0.00378528960053334685 0.00436563855952869923 -2.4340782901760421e-17 -0.00621364710496641586 0.00767831791697803825 -0.00171243357433652752 -0.00616163604060846002 0.0078025467662149392 -0.00242718198440928633 -0.00207250842928758923 -2.69482670269572561e-18 0.00273971589043762922 0.00424784545066699947 -0.0181334431724998676 0.0191056424464387774 0.00713102857720524126 -0.0433171053306363046 0.048027296350985231 -4.63898548830927448e-17 -0.0664146614211400393 0.0835250319045903605 -0.0195278271246549784 -0.0767852196335263304 0.1133483819230683 -0.0462131785245892615 -0.0688692310303714583 0.125042648384139948 -0.0688692310303714583 -0.0462131785245892615 0.1133483819230683 -0.0767852196335263304 -0.0195278271246549784 0.0835250319045903605 -0.0664146614211400393 -4.63898548830927448e-17 0.048027296350985231 -0.0433171053306363046 0.00713102857720524126 0.0191056424464387774 -0.0181334431724998676 0.00424784545066699947 0.00273971589043762922 -2.69482670269572561e-18 -0.00207250842928758923 -0.00242718198440928633 0.0078025467662149392 -0.00616163604060846002 -0.00171243357433652752 0.00767831791697803825 -0.00621364710496641586 -2.4340782901760421e-17 0.00436563855952869923 -0.00378528960053334685 0.000590901258756573256 0.00148348837617743711 -0.00130662355845370887 0.000282229865975059183 0.000167678386754142671 -3.06281499084580642e-19 -0.00011175425529768901 -0.000129286770259735601 0.000436019256172120897];
h11=[0.000128487286183474127 3.94278346872901179e-05 -9.16713189542487923e-05 5.03340960529216981e-18 0.000137545535361738948 -8.60700014172034934e-05 -0.000385039221806380118 0.00123090875463092498 -0.00192823939335524377 0.00160621274448717599 0.000390611271168093044 -0.00376112622654747875 0.00687815634087746586 -0.0072976809449737598 0.00317133604511684675 0.0051125521891700566 -0.0141806082036385339 0.0187080106326036159 -0.0141657835317268461 -6.34035688786599458e-18 0.018726207186386238 -0.0327411534722956699 0.0329563232002141118 -0.0158527042933545442 -0.0132062862493286613 0.041169748059509681 -0.0531635040341601958 0.0404088217800483568 -0.00594238734337915707 -0.0354421946236154264 0.0637235493585263796 -0.0637117220403894124 0.0334017954033525855 0.0140933643835419956 -0.0564930008893341773 0.0733643169326354261 -0.0564930008893341773 0.0140933643835419956 0.0334017954033525855 -0.0637117220403894124 0.0637235493585263796 -0.0354421946236154264 -0.00594238734337915707 0.0404088217800483568 -0.0531635040341601958 0.041169748059509681 -0.0132062862493286613 -0.0158527042933545442 0.0329563232002141118 -0.0327411534722956699 0.018726207186386238 -6.34035688786599458e-18 -0.0141657835317268461 0.0187080106326036159 -0.0141806082036385339 0.0051125521891700566 0.00317133604511684675 -0.0072976809449737598 0.00687815634087746586 -0.00376112622654747875 0.000390611271168093044 0.00160621274448717599 -0.00192823939335524377 0.00123090875463092498 -0.000385039221806380118 -8.60700014172034934e-05 0.000137545535361738948 5.03340960529216981e-18 -9.16713189542487923e-05 3.94278346872901179e-05 0.000128487286183474127];
h12=[-2.67186121963058264e-05 0.000112290871963402521 -0.00010459627338586512 -5.39328452251395955e-18 0.000156938403241276844 -0.000245128234550108287 8.00679503271826878e-05 0.000509904047700169053 -0.00155775710759053533 0.00283580472993347861 -0.0038138700226419864 0.00376145779496880146 -0.00200646106768011083 -0.00171242870904975749 0.006931305048709549 -0.0123438809331388975 0.0160032072765362333 -0.0158612837572731438 0.0105270547189127879 3.17845003740133556e-18 -0.0139160539399231179 0.027759056586137705 -0.0371921192428276565 0.0382751876215452411 -0.0288637965994242227 0.00966063864028036609 0.0155085891886527771 -0.0404123840878353388 0.0580205811370118965 -0.0625739918313007182 0.0514800248746152961 -0.0263925858290640324 -0.00694582043524658715 0.0401380443049307659 -0.0644580816859169348 0.0733707844876392151 -0.0644580816859169348 0.0401380443049307659 -0.00694582043524658715 -0.0263925858290640324 0.0514800248746152961 -0.0625739918313007182 0.0580205811370118965 -0.0404123840878353388 0.0155085891886527771 0.00966063864028036609 -0.0288637965994242227 0.0382751876215452411 -0.0371921192428276565 0.027759056586137705 -0.0139160539399231179 3.17845003740133556e-18 0.0105270547189127879 -0.0158612837572731438 0.0160032072765362333 -0.0123438809331388975 0.006931305048709549 -0.00171242870904975749 -0.00200646106768011083 0.00376145779496880146 -0.0038138700226419864 0.00283580472993347861 -0.00155775710759053533 0.000509904047700169053 8.00679503271826878e-05 -0.000245128234550108287 0.000156938403241276844 -5.39328452251395955e-18 -0.00010459627338586512 0.000112290871963402521 -2.67186121963058264e-05];
h13=[-0.00131386743618066323 0.00107862911854386049 -0.000671411784542617408 4.14760204905558731e-18 0.00100740007241722986 -0.00235462105636836299 0.00393728056845532755 -0.00552328073851898402 0.00676437110077386921 -0.00724299509030350633 0.00655069450737536321 -0.00438612795038379692 0.000654063810752476197 0.00445681308389231107 -0.0104386350050754591 0.0164874653823924959 -0.0215909657045400237 0.024674433126384173 -0.024786177542908603 0.0212924232641823474 -0.014045660268957311 0.00349047946121874364 0.00932181342046257966 -0.0228246788040494496 0.0351303809959838259 -0.0443032171177454581 0.0486711442628643548 -0.0471237209218160133 0.0393419815951730686 -0.0259138379369878886 0.00830611771443356614 0.0113113430470639705 -0.0303674102714001741 0.0462710132321903084 -0.0568096037577037263 0.0604969205013192665 -0.0568096037577037263 0.0462710132321903084 -0.0303674102714001741 0.0113113430470639705 0.00830611771443356614 -0.0259138379369878886 0.0393419815951730686 -0.0471237209218160133 0.0486711442628643548 -0.0443032171177454581 0.0351303809959838259 -0.0228246788040494496 0.00932181342046257966 0.00349047946121874364 -0.014045660268957311 0.0212924232641823474 -0.024786177542908603 0.024674433126384173 -0.0215909657045400237 0.0164874653823924959 -0.0104386350050754591 0.00445681308389231107 0.000654063810752476197 -0.00438612795038379692 0.00655069450737536321 -0.00724299509030350633 0.00676437110077386921 -0.00552328073851898402 0.00393728056845532755 -0.00235462105636836299 0.00100740007241722986 4.14760204905558731e-18 -0.000671411784542617408 0.00107862911854386049 -0.00131386743618066323];
h14=[0.00102952293857410857 -0.000802140354897016628 0.000484643183233476231 -1.30520478350348473e-17 -0.000727168615633567387 0.0017510528293108547 -0.00308518237776727634 0.00468618890034106991 -0.00644383648620883674 0.00817979292200713033 -0.00965666636788632682 0.0105975924135528459 -0.0107152584058818022 0.00974785623859015203 -0.00749823304850054211 0.00387162665382418661 0.00109302990737690097 -0.00720307313487093467 0.0141073818606346751 -0.0213096011552391558 0.0282000710202511551 -0.0341050075812590614 0.0383492032394331314 -0.0403264392207268521 0.0395702327638016577 -0.0358167355723916711 0.0290517516032802077 -0.0195350317074750382 0.00779717391519787334 0.00539259028215921012 -0.019086044021183135 0.0322379670602966489 -0.0438023718104002882 0.052832807260399163 -0.0585756433536950213 0.0605457270414091128 -0.0585756433536950213 0.052832807260399163 -0.0438023718104002882 0.0322379670602966489 -0.019086044021183135 0.00539259028215921012 0.00779717391519787334 -0.0195350317074750382 0.0290517516032802077 -0.0358167355723916711 0.0395702327638016577 -0.0403264392207268521 0.0383492032394331314 -0.0341050075812590614 0.0282000710202511551 -0.0213096011552391558 0.0141073818606346751 -0.00720307313487093467 0.00109302990737690097 0.00387162665382418661 -0.00749823304850054211 0.00974785623859015203 -0.0107152584058818022 0.0105975924135528459 -0.00965666636788632682 0.00817979292200713033 -0.00644383648620883674 0.00468618890034106991 -0.00308518237776727634 0.0017510528293108547 -0.000727168615633567387 -1.30520478350348473e-17 0.000484643183233476231 -0.000802140354897016628 0.00102952293857410857];
h15=[-0.000654256851461900314 0.000493051424551008166 -0.000292129821246409549 2.19129630898307452e-17 0.000438317601588329741 -0.00107631923351694239 0.00196061848943296022 -0.00312547975221703824 0.00458767155316872153 -0.00634202990966878117 0.00835810149795374741 -0.0105781939202459624 0.0129170968397968929 -0.0152636554077810252 0.0174842786650496809 -0.019428353491196506 0.0209354130213457723 -0.0218437822319010773 0.0220002990356822151 -0.0212705947338514487 0.0195493224735976689 -0.0167696567501137081 0.0129113611773123901 -0.00800674457282616117 0.00214390286273532724 0.00453322184937849336 -0.011828247145694238 0.0194992735685469883 -0.0272691206425698836 0.0348384067730810806 -0.0419007565085834366 0.0481592119996582246 -0.0533427822573904753 0.0572220017022777444 -0.0596223990358401637 0.0604349003710734287 -0.0596223990358401637 0.0572220017022777444 -0.0533427822573904753 0.0481592119996582246 -0.0419007565085834366 0.0348384067730810806 -0.0272691206425698836 0.0194992735685469883 -0.011828247145694238 0.00453322184937849336 0.00214390286273532724 -0.00800674457282616117 0.0129113611773123901 -0.0167696567501137081 0.0195493224735976689 -0.0212705947338514487 0.0220002990356822151 -0.0218437822319010773 0.0209354130213457723 -0.019428353491196506 0.0174842786650496809 -0.0152636554077810252 0.0129170968397968929 -0.0105781939202459624 0.00835810149795374741 -0.00634202990966878117 0.00458767155316872153 -0.00312547975221703824 0.00196061848943296022 -0.00107631923351694239 0.000438317601588329741 2.19129630898307452e-17 -0.000292129821246409549 0.000493051424551008166 -0.000654256851461900314];
h16=[0.000136315323397507557 -0.000101073730476901948 5.93088095329573334e-05 -8.26902141426386274e-18 -8.89881595676459981e-05 0.000220641488288275255 -0.000408497584471600745 0.000666318096422295332 -0.00100773695285722559 0.00144588979552522784 -0.00199303000388702158 0.00266013697959756757 -0.00345652286972176126 0.00438944472149165651 -0.00546373019624924426 0.00668142638060543331 -0.00804148280470014416 0.00953948133188129051 -0.0111674268907073788 0.0129136138186164134 -0.0147625826150623272 0.0166951809290135054 -0.018688740462673846 0.0207173780825011151 -0.0227524248248215342 0.0247629808246720255 -0.0267165877629903896 0.0285800036064592471 -0.0303200576743624245 0.0319045579193599216 -0.0333032172649833508 0.034488562365021902 -0.035436786609093246 0.0361285098335379501 -0.0365494100871709346 0.0366906978541870557 -0.0365494100871709346 0.0361285098335379501 -0.035436786609093246 0.034488562365021902 -0.0333032172649833508 0.0319045579193599216 -0.0303200576743624245 0.0285800036064592471 -0.0267165877629903896 0.0247629808246720255 -0.0227524248248215342 0.0207173780825011151 -0.018688740462673846 0.0166951809290135054 -0.0147625826150623272 0.0129136138186164134 -0.0111674268907073788 0.00953948133188129051 -0.00804148280470014416 0.00668142638060543331 -0.00546373019624924426 0.00438944472149165651 -0.00345652286972176126 0.00266013697959756757 -0.00199303000388702158 0.00144588979552522784 -0.00100773695285722559 0.000666318096422295332 -0.000408497584471600745 0.000220641488288275255 -8.89881595676459981e-05 -8.26902141426386274e-18 5.93088095329573334e-05 -0.000101073730476901948 0.000136315323397507557];

% h=[h1;h2;h3;h4;h5;h6;h7;h8;h9;h10;h11;h12;h13;h14;h15;h16];
% h=round(h*2^15);
% h1=mul_less(h);
% h2=h-h1;
% h3=mul_less(h2);
% h4=h-h1-h3;
% h5=mul_less(h4);
% h6=h-h1-h3-h5;
% h7=mul_less(h6);
% h8=h-h1-h3-h5-h7;
% h9=mul_less(h8);
% h=h1+h3+h5+h7+h9;
[H1,W]=freqz(h1,1,8000,Fs);
[H2,W]=freqz(h2,1,8000,Fs);
[H3,W]=freqz(h3,1,8000,Fs);
[H4,W]=freqz(h4,1,8000,Fs);
[H5,W]=freqz(h5,1,8000,Fs);
[H6,W]=freqz(h6,1,8000,Fs);
[H7,W]=freqz(h7,1,8000,Fs);
[H8,W]=freqz(h8,1,8000,Fs);
[H9,W]=freqz(h9,1,8000,Fs);
[H10,W]=freqz(h10,1,8000,Fs);
[H11,W]=freqz(h11,1,8000,Fs);
[H12,W]=freqz(h12,1,8000,Fs);
[H13,W]=freqz(h13,1,8000,Fs);
[H14,W]=freqz(h14,1,8000,Fs);
[H15,W]=freqz(h15,1,8000,Fs);
[H16,W]=freqz(h16,1,8000,Fs);
HG=20*log10(abs(G(1)*H1+G(2)*H2+G(3)*H3+G(4)*H4+G(5)*H5+G(6)*H6+G(7)*H7+G(8)*H8+G(9)*H9+G(10)*H10+G(11)*H11+G(12)*H12+G(13)*H13+G(14)*H14+G(15)*H15+G(16)*H16));
figure; 
plot(f,i,j,g,W,20*log10(abs(G(1)*H1)),W,20*log10(abs(G(2)*H2)),W,20*log10(abs(G(3)*H3)),W,20*log10(abs(G(4)*H4)),...
W,20*log10(abs(G(5)*H5)),W,20*log10(abs(G(6)*H6)),W,20*log10(G(7)*abs(H7)),W,20*log10(abs(G(8)*H8)),...
W,20*log10(abs(G(9)*H9)),W,20*log10(abs(G(10)*H10)),W,20*log10(abs(G(11)*H11)),W,20*log10(abs(G(12)*H12)),...
W,20*log10(abs(G(13)*H13)),W,20*log10(abs(G(14)*H14)),W,20*log10(G(15)*abs(H15)),W,20*log10(abs(G(16)*H16)),...
W,(HG));
axis([0 8000 -100 100]);
xlabel('Frequency (Hz)')
ylabel('Intensity of HL(dB)')
figure; 
ME=[i(1)-HG(250), i(2)-HG(500), i(3)-HG(1000), i(4)-HG(2000), i(5)-HG(4000), i(6)-HG(8000)];
plot(f,i,W,(HG),f,ME);
grid
axis([0 8000 -10 100]);
set(gca, 'yDir', 'reverse'); 
xlabel('Frequency (Hz)')
ylabel('Magnitude (dB)')
title('Matching error');

 
% [x,Fs]=audioread('f2bjrop1.0.wav');
% t=0:1/Fs:11.14-1/Fs;
% y=filter(h(1,:),1,x);
% y1=filter(h1(1,:),1,x);
% y2=filter(h3(1,:),1,x);
% y3=filter(h5(1,:),1,x);
% y4=filter(h7(1,:),1,x);
% y5=filter(h9(1,:),1,x);
% yo=y1+y2+y3+y4+y5;
% yo=yo/2^15;
% y=y/2^15;
% figure;
% subplot(3,1,1);
% plot(t,x);
% subplot(3,1,2);
% plot(t,yo);
% subplot(3,1,3);
% plot(t,yo-y);